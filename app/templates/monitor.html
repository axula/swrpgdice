<html>
    <head>
        <title>Star Wars Dice Roller Monitor</title>
        <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
        <script type="text/javascript" charset="utf-8">
        $(document).ready(function(){
                // change to an empty string to use the global namespace
                // the socket.io documentation recommends sending an 
                // explicit package upon connection
                // this is specially important when using the global namespace
                var socket = io.connect('http://' + document.domain + ':' + location.port + '/swdice');
                // event handler for server sent data
                // the data is displayed in the "Received" section of the page
                socket.on('edroll', function(msg) {
                        var data = $.parseJSON(msg.data);
                        var dice = data["dice"];
                        var date = new Date()
                        var roll = "<li> " + data["player"] + " rolled at " + date.toLocaleTimeString() + ": ";
                        $(dice).each(function (i) {
                                roll += "<img src='/static/swdice/" + dice[i] + ".png' /> ";
                        })
                        var totalstring = data["total"];
                        roll += totalstring;
                        roll += "</li><hr/>";
                        $('#placeholder').prepend(roll);
                });
                // event handler for new connections
                socket.on('connect', function() {
                        return false;
                });
        });
        </script>
    </head>
    <body>
    <h2>Recent rolls:</h2>
    <div><ul id='placeholder' style='list-style-type:none'> </ul></div>
    </body>
</html>
